# Deployment Patterns

## Feature toggles

- [Feature toggles](https://martinfowler.com/bliki/FeatureToggle.html) are booleans in code that activates or deactivates a feature in run-time
- **Benefits**:
  - Separate deployment from release
  - Gradually enable features to different user segments
  - A/B testing capabilities
  - Instant rollback without redeployment
- **Azure App Configuration Integration (2025)**:
  - Centralized feature flag management
  - Real-time toggling without code changes
  - Target specific users or groups
  - Integration with Azure Pipelines and GitHub Actions

## Blue Green deployments

- The essence of blue-green is deploying all at once
- Easy rollbacks in case of failure.
- Completely automated deployment process
- Zero downtime deployment
- Concept
  - Blue version = Current version, users use it
  - Green version = New version on production, not yet available
  - You redirect users to Green release and at the end it becomes your Blue release.
- Azure Traffic Manager [allows it](https://azure.microsoft.com/en-us/blog/blue-green-deployments-using-azure-traffic-manager/) with its [weighted](https://docs.microsoft.com/en-us/azure/traffic-manager/traffic-manager-routing-methods#weighted) round-robin routing method

## Canary Deployments

- The essence of canary deployment is deploying incrementally
- Deploys in small, incremental steps, and only to a small group of people
- It is about to get an idea of how new version will perform (integrate with other apps, CPU, memory, disk usage, etc).
- **Progressive Canary (2025)**:
  - Start with 5-10% of users
  - Monitor metrics and errors
  - Gradually increase: 25% → 50% → 100%
  - Automatic rollback on critical errors

## Rolling deployment

- Slowly replaces currently running instances of the application with newer ones.
- Noting that the old one is removed only when the new is has passed health checks is important

## Ring-Based Deployments (2025)

- **Ring 0 - Internal Users (Employees)**:
  - First to receive new features
  - Identify critical issues before wider rollout
  - Fast feedback from known users
- **Ring 1 - Early Adopters/Beta Testers**:
  - Voluntary participants for preview features
  - More refined than Ring 0
  - Representative user base
- **Ring 2 - General Availability**:
  - All users receive the release
  - Only after validation from previous rings

## Progressive Delivery (2025)

- **Automated Rollouts**:
  - Progressive percentage increases (5% → 25% → 50% → 100%)
  - Automatic pause on error threshold breaches
  - Integration with monitoring and alerting
- **Progressive Rollout with Feature Flags**:
  - Enable features for specific user segments
  - Time-based activations
  - Geographic-based rollouts

## Modern Deployment Best Practices (2025)

- **GitHub Actions and Azure Pipelines Integration**:
  - Unified workflows across platforms
  - OIDC authentication for secure deployments
  - Environment protections and approvals
- **Deployment Validation**:
  - Automated testing at each stage
  - Synthetic transactions for validation
  - Integration with Azure Monitor and Application Insights
- **Infrastructure as Code**:
  - **Azure Deployment Environments**: On-demand test environments
  - **Bicep/Terraform**: Infrastructure provisioning
  - Version-controlled infrastructure
- **Monitoring and Observability**:
  - Real-time metrics and logs
  - Distributed tracing
  - Automated rollback on anomalies
